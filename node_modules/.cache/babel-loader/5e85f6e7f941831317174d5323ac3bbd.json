{"ast":null,"code":"/**\n * @license\n * Copyright 2018 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport { ENGINE } from '../engine';\nimport { convertToTensor } from '../tensor_util_env';\nimport * as util from '../util';\nimport { op } from './operation';\n/**\n * Reverses a `tf.Tensor1D`.\n *\n * @param x The input tensor.\n */\n\nfunction reverse1d_(x) {\n  const $x = convertToTensor(x, 'x', 'reverse');\n  util.assert($x.rank === 1, () => `Error in reverse1D: x must be rank 1 but got rank ${$x.rank}.`);\n  return reverse($x, 0);\n}\n/**\n * Reverses a `tf.Tensor2D` along a specified axis.\n *\n * @param x The input tensor.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\n\n\nfunction reverse2d_(x, axis) {\n  const $x = convertToTensor(x, 'x', 'reverse');\n  util.assert($x.rank === 2, () => `Error in reverse2D: x must be rank 2 but got rank ${$x.rank}.`);\n  return reverse($x, axis);\n}\n/**\n * Reverses a `tf.Tensor3D` along a specified axis.\n *\n * @param x The input tensor.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\n\n\nfunction reverse3d_(x, axis) {\n  const $x = convertToTensor(x, 'x', 'reverse');\n  util.assert($x.rank === 3, () => `Error in reverse3D: x must be rank 3 but got rank ${$x.rank}.`);\n  return reverse($x, axis);\n}\n/**\n * Reverses a `tf.Tensor4D` along a specified axis.\n *\n * @param x The input tensor.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\n\n\nfunction reverse4d_(x, axis) {\n  const $x = convertToTensor(x, 'x', 'reverse');\n  util.assert($x.rank === 4, () => `Error in reverse4D: x must be rank 4 but got rank ${$x.rank}.`);\n  return reverse($x, axis);\n}\n/**\n * Reverses a `tf.Tensor` along a specified axis.\n *\n * Also available are stricter rank-specific methods that assert that `x` is\n * of the given rank:\n *   - `tf.reverse1d`\n *   - `tf.reverse2d`\n *   - `tf.reverse3d`\n *   - `tf.reverse4d`\n *\n * Except `tf.reverse1d` (which does not have axis param), all methods have\n * same signature as this method.\n *\n * ```js\n * const x = tf.tensor1d([1, 2, 3, 4]);\n *\n * x.reverse().print();\n * ```\n *\n * ```js\n * const x = tf.tensor2d([1, 2, 3, 4], [2, 2]);\n *\n * const axis = 1;\n * x.reverse(axis).print();\n * ```\n * @param x The input tensor to be reversed.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\n\n/** @doc {heading: 'Tensors', subheading: 'Slicing and Joining'} */\n\n\nfunction reverse_(x, axis) {\n  const $x = convertToTensor(x, 'x', 'reverse');\n\n  if ($x.rank === 0) {\n    return $x.clone();\n  }\n\n  const axes = util.parseAxisParam(axis, $x.shape);\n\n  const grad = dy => {\n    return {\n      $x: () => dy.reverse(axes)\n    };\n  };\n\n  const res = ENGINE.runKernelFunc(backend => backend.reverse($x, axes), {\n    $x\n  }, grad);\n  return res.reshapeAs($x);\n}\n\nexport const reverse = op({\n  reverse_\n});\nexport const reverse1d = op({\n  reverse1d_\n});\nexport const reverse2d = op({\n  reverse2d_\n});\nexport const reverse3d = op({\n  reverse3d_\n});\nexport const reverse4d = op({\n  reverse4d_\n});","map":{"version":3,"sources":["../../src/ops/reverse.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright 2018 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport { ENGINE } from '../engine';\nimport { convertToTensor } from '../tensor_util_env';\nimport * as util from '../util';\nimport { op } from './operation';\n/**\n * Reverses a `tf.Tensor1D`.\n *\n * @param x The input tensor.\n */\nfunction reverse1d_(x) {\n    const $x = convertToTensor(x, 'x', 'reverse');\n    util.assert($x.rank === 1, () => `Error in reverse1D: x must be rank 1 but got rank ${$x.rank}.`);\n    return reverse($x, 0);\n}\n/**\n * Reverses a `tf.Tensor2D` along a specified axis.\n *\n * @param x The input tensor.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\nfunction reverse2d_(x, axis) {\n    const $x = convertToTensor(x, 'x', 'reverse');\n    util.assert($x.rank === 2, () => `Error in reverse2D: x must be rank 2 but got rank ${$x.rank}.`);\n    return reverse($x, axis);\n}\n/**\n * Reverses a `tf.Tensor3D` along a specified axis.\n *\n * @param x The input tensor.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\nfunction reverse3d_(x, axis) {\n    const $x = convertToTensor(x, 'x', 'reverse');\n    util.assert($x.rank === 3, () => `Error in reverse3D: x must be rank 3 but got rank ${$x.rank}.`);\n    return reverse($x, axis);\n}\n/**\n * Reverses a `tf.Tensor4D` along a specified axis.\n *\n * @param x The input tensor.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\nfunction reverse4d_(x, axis) {\n    const $x = convertToTensor(x, 'x', 'reverse');\n    util.assert($x.rank === 4, () => `Error in reverse4D: x must be rank 4 but got rank ${$x.rank}.`);\n    return reverse($x, axis);\n}\n/**\n * Reverses a `tf.Tensor` along a specified axis.\n *\n * Also available are stricter rank-specific methods that assert that `x` is\n * of the given rank:\n *   - `tf.reverse1d`\n *   - `tf.reverse2d`\n *   - `tf.reverse3d`\n *   - `tf.reverse4d`\n *\n * Except `tf.reverse1d` (which does not have axis param), all methods have\n * same signature as this method.\n *\n * ```js\n * const x = tf.tensor1d([1, 2, 3, 4]);\n *\n * x.reverse().print();\n * ```\n *\n * ```js\n * const x = tf.tensor2d([1, 2, 3, 4], [2, 2]);\n *\n * const axis = 1;\n * x.reverse(axis).print();\n * ```\n * @param x The input tensor to be reversed.\n * @param axis The set of dimensions to reverse. Must be in the\n *     range [-rank(x), rank(x)). Defaults to all axes.\n */\n/** @doc {heading: 'Tensors', subheading: 'Slicing and Joining'} */\nfunction reverse_(x, axis) {\n    const $x = convertToTensor(x, 'x', 'reverse');\n    if ($x.rank === 0) {\n        return $x.clone();\n    }\n    const axes = util.parseAxisParam(axis, $x.shape);\n    const grad = (dy) => {\n        return { $x: () => dy.reverse(axes) };\n    };\n    const res = ENGINE.runKernelFunc(backend => backend.reverse($x, axes), { $x }, grad);\n    return res.reshapeAs($x);\n}\nexport const reverse = op({ reverse_ });\nexport const reverse1d = op({ reverse1d_ });\nexport const reverse2d = op({ reverse2d_ });\nexport const reverse3d = op({ reverse3d_ });\nexport const reverse4d = op({ reverse4d_ });\n//# sourceMappingURL=reverse.js.map"]},"metadata":{},"sourceType":"module"}