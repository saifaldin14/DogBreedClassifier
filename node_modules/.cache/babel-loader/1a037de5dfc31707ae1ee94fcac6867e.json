{"ast":null,"code":"/**\n * @license\n * Copyright 2018 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport * as tfc from '@tensorflow/tfjs-core';\nimport { getParamValue } from './utils';\nexport const executeOp = async (node, tensorMap, context) => {\n  switch (node.op) {\n    case 'NonMaxSuppressionV5':\n    case 'NonMaxSuppressionV3':\n    case 'NonMaxSuppressionV2':\n      {\n        const boxes = getParamValue('boxes', node, tensorMap, context);\n        const scores = getParamValue('scores', node, tensorMap, context);\n        const maxOutputSize = getParamValue('maxOutputSize', node, tensorMap, context);\n        const iouThreshold = getParamValue('iouThreshold', node, tensorMap, context);\n        const scoreThreshold = getParamValue('scoreThreshold', node, tensorMap, context);\n\n        if (node.op === 'NonMaxSuppressionV5') {\n          const softNmsSigma = getParamValue('softNmsSigma', node, tensorMap, context);\n          const result = await tfc.image.nonMaxSuppressionWithScoreAsync(boxes, scores, maxOutputSize, iouThreshold, scoreThreshold, softNmsSigma);\n          return [result.selectedIndices, result.selectedScores];\n        }\n\n        return [await tfc.image.nonMaxSuppressionAsync(boxes, scores, maxOutputSize, iouThreshold, scoreThreshold)];\n      }\n\n    case 'Where':\n      {\n        const condition = getParamValue('condition', node, tensorMap, context).asType('bool');\n        const result = [await tfc.whereAsync(condition)];\n        condition.dispose();\n        return result;\n      }\n\n    case 'ListDiff':\n      {\n        return tfc.setdiff1dAsync(getParamValue('x', node, tensorMap, context), getParamValue('y', node, tensorMap, context));\n      }\n\n    default:\n      throw TypeError(`Node type ${node.op} is not implemented`);\n  }\n};\nexport const CATEGORY = 'dynamic';","map":{"version":3,"sources":["../../../src/operations/executors/dynamic_executor.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;AAiBA,OAAO,KAAK,GAAZ,MAAqB,uBAArB;AAMA,SAAQ,aAAR,QAA4B,SAA5B;AAEA,OAAO,MAAM,SAAS,GAA4B,OAC9C,IAD8C,EAClC,SADkC,EAE9C,OAF8C,KAEM;AACtD,UAAQ,IAAI,CAAC,EAAb;AACE,SAAK,qBAAL;AACA,SAAK,qBAAL;AACA,SAAK,qBAAL;AAA4B;AAC1B,cAAM,KAAK,GACP,aAAa,CAAC,OAAD,EAAU,IAAV,EAAgB,SAAhB,EAA2B,OAA3B,CADjB;AAEA,cAAM,MAAM,GACR,aAAa,CAAC,QAAD,EAAW,IAAX,EAAiB,SAAjB,EAA4B,OAA5B,CADjB;AAEA,cAAM,aAAa,GACf,aAAa,CAAC,eAAD,EAAkB,IAAlB,EAAwB,SAAxB,EAAmC,OAAnC,CADjB;AAEA,cAAM,YAAY,GACd,aAAa,CAAC,cAAD,EAAiB,IAAjB,EAAuB,SAAvB,EAAkC,OAAlC,CADjB;AAEA,cAAM,cAAc,GAChB,aAAa,CAAC,gBAAD,EAAmB,IAAnB,EAAyB,SAAzB,EAAoC,OAApC,CADjB;;AAGA,YAAI,IAAI,CAAC,EAAL,KAAY,qBAAhB,EAAuC;AACrC,gBAAM,YAAY,GACd,aAAa,CAAC,cAAD,EAAiB,IAAjB,EAAuB,SAAvB,EAAkC,OAAlC,CADjB;AAGA,gBAAM,MAAM,GAAG,MAAM,GAAG,CAAC,KAAJ,CAAU,+BAAV,CACjB,KADiB,EACM,MADN,EAC8B,aAD9B,EAEjB,YAFiB,EAEH,cAFG,EAEa,YAFb,CAArB;AAIA,iBAAO,CAAC,MAAM,CAAC,eAAR,EAAyB,MAAM,CAAC,cAAhC,CAAP;AACD;;AAED,eAAO,CAAC,MAAM,GAAG,CAAC,KAAJ,CAAU,sBAAV,CACV,KADU,EACa,MADb,EACqC,aADrC,EAEV,YAFU,EAEI,cAFJ,CAAP,CAAP;AAGD;;AACD,SAAK,OAAL;AAAc;AACZ,cAAM,SAAS,GACV,aAAa,CAAC,WAAD,EAAc,IAAd,EAAoB,SAApB,EAA+B,OAA/B,CAAb,CACI,MADJ,CACW,MADX,CADL;AAGA,cAAM,MAAM,GAAG,CAAC,MAAM,GAAG,CAAC,UAAJ,CAAe,SAAf,CAAP,CAAf;AACA,QAAA,SAAS,CAAC,OAAV;AACA,eAAO,MAAP;AACD;;AACD,SAAK,UAAL;AAAiB;AACf,eAAO,GAAG,CAAC,cAAJ,CACH,aAAa,CAAC,GAAD,EAAM,IAAN,EAAY,SAAZ,EAAuB,OAAvB,CADV,EAEH,aAAa,CAAC,GAAD,EAAM,IAAN,EAAY,SAAZ,EAAuB,OAAvB,CAFV,CAAP;AAGD;;AACD;AACE,YAAM,SAAS,CAAC,aAAa,IAAI,CAAC,EAAE,qBAArB,CAAf;AA5CJ;AA8CD,CAjDM;AAmDP,OAAO,MAAM,QAAQ,GAAG,SAAjB","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright 2018 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport * as tfc from '@tensorflow/tfjs-core';\nimport { getParamValue } from './utils';\nexport const executeOp = async (node, tensorMap, context) => {\n    switch (node.op) {\n        case 'NonMaxSuppressionV5':\n        case 'NonMaxSuppressionV3':\n        case 'NonMaxSuppressionV2': {\n            const boxes = getParamValue('boxes', node, tensorMap, context);\n            const scores = getParamValue('scores', node, tensorMap, context);\n            const maxOutputSize = getParamValue('maxOutputSize', node, tensorMap, context);\n            const iouThreshold = getParamValue('iouThreshold', node, tensorMap, context);\n            const scoreThreshold = getParamValue('scoreThreshold', node, tensorMap, context);\n            if (node.op === 'NonMaxSuppressionV5') {\n                const softNmsSigma = getParamValue('softNmsSigma', node, tensorMap, context);\n                const result = await tfc.image.nonMaxSuppressionWithScoreAsync(boxes, scores, maxOutputSize, iouThreshold, scoreThreshold, softNmsSigma);\n                return [result.selectedIndices, result.selectedScores];\n            }\n            return [await tfc.image.nonMaxSuppressionAsync(boxes, scores, maxOutputSize, iouThreshold, scoreThreshold)];\n        }\n        case 'Where': {\n            const condition = getParamValue('condition', node, tensorMap, context)\n                .asType('bool');\n            const result = [await tfc.whereAsync(condition)];\n            condition.dispose();\n            return result;\n        }\n        case 'ListDiff': {\n            return tfc.setdiff1dAsync(getParamValue('x', node, tensorMap, context), getParamValue('y', node, tensorMap, context));\n        }\n        default:\n            throw TypeError(`Node type ${node.op} is not implemented`);\n    }\n};\nexport const CATEGORY = 'dynamic';\n//# sourceMappingURL=dynamic_executor.js.map"]},"metadata":{},"sourceType":"module"}